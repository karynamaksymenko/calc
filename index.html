<!-- Calculator: y and p (self-contained) -->
<style>
  :root{
    --bg:#f6f7fb;
    --card:#ffffff;
    --text:#0f172a;
    --muted:#64748b;
    --stroke:#e2e8f0;
    --accent:#2563eb;
    --accent-2:#1d4ed8;
    --result:#1e40af;
    --result-bg:#dbeafe;
    --danger:#dc2626;
    --radius:14px;
  }

  .calc-page{
    font-family: Arial, Helvetica, sans-serif;
    background: var(--bg);
    color: var(--text);
    padding: 48px 16px;
  }

  .calc-wrap{
    max-width: 980px;
    margin: 0 auto;
  }

  .calc-header{
    margin-bottom: 18px;
  }

  .calc-title{
    font-size: 28px;
    line-height: 1.2;
    margin: 0 0 6px;
    font-weight: 700;
  }

  .calc-subtitle{
    margin: 0;
    color: var(--muted);
    font-size: 14px;
    line-height: 1.5;
  }

  .calc-grid{
    display: grid;
    grid-template-columns: 1.2fr 0.8fr;
    gap: 18px;
    align-items: start;
  }

  .card{
    background: var(--card);
    border: 1px solid var(--stroke);
    border-radius: var(--radius);
    box-shadow: 0 10px 30px rgba(15,23,42,0.06);
  }

  .card-pad{
    padding: 18px;
  }

  .form-grid{
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
  }

  .field{
    display:flex;
    flex-direction:column;
    gap: 6px;
  }

  .label{
    font-size: 12px;
    color: var(--muted);
    font-weight: 700;
    letter-spacing: 0.06em;
    text-transform: uppercase;
  }

  .input{
    height: 42px;
    border: 1px solid var(--stroke);
    border-radius: 10px;
    padding: 0 12px;
    font-size: 14px;
    outline: none;
    background: #fff;
  }

  .input:focus{
    border-color: rgba(37,99,235,0.55);
    box-shadow: 0 0 0 3px rgba(37,99,235,0.15);
  }

  .radio-row{
    display:flex;
    gap: 12px;
    align-items:center;
    height: 42px;
    border: 1px solid var(--stroke);
    border-radius: 10px;
    padding: 0 12px;
  }

  .radio-row label{
    display:flex;
    gap: 8px;
    align-items:center;
    font-size: 14px;
    color: var(--text);
  }

  .actions{
    display:flex;
    gap: 10px;
    margin-top: 14px;
    flex-wrap: wrap;
  }

  .btn{
    appearance: none;
    border: 0;
    border-radius: 12px;
    padding: 12px 14px;
    font-weight: 700;
    font-size: 14px;
    cursor: pointer;
  }

  .btn-primary{
    background: var(--accent);
    color: #fff;
  }
  .btn-primary:hover{ background: var(--accent-2); }

  .btn-ghost{
    background: transparent;
    border: 1px solid var(--stroke);
    color: var(--text);
  }

  .error{
    margin-top: 10px;
    color: var(--danger);
    font-size: 13px;
    display:none;
  }

  /* Results */
  .results{
    display:flex;
    flex-direction: column;
    gap: 12px;
  }

  .result-box{
    border-radius: 14px;
    padding: 14px;
    background: var(--result-bg);
    border: 1px solid rgba(30,64,175,0.20);
  }

  .result-kicker{
    font-size: 12px;
    color: rgba(30,64,175,0.85);
    font-weight: 800;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    margin: 0 0 6px;
  }

  .result-value{
    margin: 0;
    font-size: 22px;
    font-weight: 900;
    color: var(--result);
    word-break: break-word;
  }

  .meta{
    display:grid;
    grid-template-columns: 1fr;
    gap: 10px;
  }

  .meta .mini{
    background:#fff;
    border:1px solid var(--stroke);
    border-radius: 14px;
    padding: 12px;
  }

  .mini .k{ margin:0 0 4px; font-size:12px; color: var(--muted); font-weight:800; letter-spacing:.05em; text-transform:uppercase;}
  .mini .v{ margin:0; font-size:14px; font-weight:800; color: var(--text); }

  /* Formula blocks */
  .formula-wrap{
    margin-top: 14px;
    display:grid;
    gap: 10px;
  }

  .formula{
    display:none;
    background:#0b1220;
    color:#e5e7eb;
    border-radius: 14px;
    padding: 12px 14px;
    border: 1px solid rgba(148,163,184,0.22);
    font-family: "Courier New", Courier, monospace;
    font-size: 13px;
    line-height: 1.55;
    overflow:auto;
  }

  .toggle-row{
    display:flex;
    gap:10px;
    flex-wrap: wrap;
  }

  .toggle{
    background: transparent;
    border: 1px solid var(--stroke);
    color: var(--text);
    border-radius: 12px;
    padding: 10px 12px;
    font-weight: 800;
    cursor:pointer;
    font-size: 13px;
  }

  .toggle[data-open="true"]{
    border-color: rgba(37,99,235,0.35);
    box-shadow: 0 0 0 3px rgba(37,99,235,0.10);
  }

  @media (max-width: 860px){
    .calc-grid{ grid-template-columns: 1fr; }
    .form-grid{ grid-template-columns: 1fr; }
  }
</style>

<section class="calc-page">
  <div class="calc-wrap">
    <header class="calc-header">
      <h1 class="calc-title">Розрахунок за формулою (y та p)</h1>
      <p class="calc-subtitle">
        Усі поля обовʼязкові. Спочатку рахується y, потім y підставляється у формулу p.
      </p>
    </header>

    <div class="calc-grid">
      <!-- LEFT: Inputs -->
      <div class="card card-pad">
        <form id="calcForm" novalidate>
          <div class="form-grid">
            <div class="field">
              <div class="label">ГГТ (U/L)</div>
              <input class="input" id="ggt" type="number" min="0" step="0.01" required />
            </div>

            <div class="field">
              <div class="label">АСТ (U/L)</div>
              <input class="input" id="ast" type="number" min="0" step="0.01" required />
            </div>

            <div class="field">
              <div class="label">АЛТ (U/L)</div>
              <input class="input" id="alt" type="number" min="0" step="0.01" required />
            </div>

            <div class="field">
              <div class="label">Вік (років)</div>
              <input class="input" id="age" type="number" min="0" step="1" required />
            </div>

            <div class="field">
              <div class="label">Стать</div>
              <div class="radio-row">
                <label><input type="radio" name="sex" value="0" checked /> Жінка</label>
                <label><input type="radio" name="sex" value="1" /> Чоловік</label>
              </div>
            </div>

            <div class="field">
              <div class="label">Холестерин</div>
              <input class="input" id="chol" type="number" min="0" step="0.01" required />
            </div>
          </div>

          <div class="actions">
            <button class="btn btn-primary" type="submit">Розрахувати</button>
            <button class="btn btn-ghost" type="button" id="resetBtn">Скинути</button>
          </div>

          <div class="error" id="errorBox"></div>

          <div class="formula-wrap">
            <div class="toggle-row">
              <button class="toggle" type="button" id="toggleY" data-open="false">Показати формулу y</button>
              <button class="toggle" type="button" id="toggleP" data-open="false">Показати формулу p</button>
            </div>

            <div class="formula" id="formulaY">
y = K_RATIO·(GGT/AST) + K_ALT·ALT + K_AGE·AGE + K_SEX·SEX + K_CHOL·CHOL + CONST
де:
SEX = 0 (жінка) або 1 (чоловік)
            </div>

            <div class="formula" id="formulaP">
p = 1 / (1 + 2.718^(−y)) · 100
еквівалентно:
p = 1 / (1 + e^(−y)) · 100
            </div>
          </div>
        </form>
      </div>

      <!-- RIGHT: Results -->
      <aside class="results">
        <div class="result-box">
          <p class="result-kicker">y =</p>
          <p class="result-value" id="outY">—</p>
        </div>

        <div class="result-box">
          <p class="result-kicker">p =</p>
          <p class="result-value" id="outP">—</p>
        </div>

        <div class="meta">
          <div class="mini">
            <p class="k">Співвідношення ГГТ/АСТ</p>
            <p class="v" id="outRatio">—</p>
          </div>
          <div class="mini">
            <p class="k">Категорія (за p)</p>
            <p class="v" id="outRisk">—</p>
          </div>
        </div>
      </aside>
    </div>
  </div>
</section>

<script>
  // ====== COEFFICIENTS (edit here if needed) ======
  // У PDF коефіцієнт біля (GGT/AST) може бути зі знаком ± через кодування.
  // Поміняй K_RATIO на +1.44 або -1.44, якщо потрібно, і все інше лишається.
  const K_RATIO = -1.44;   // (GGT/AST)
  const K_ALT   = -0.0006; // ALT
  const K_AGE   = -0.11;   // AGE
  const K_SEX   = -1.93;   // SEX (0/1)
  const K_CHOL  =  0.385;  // CHOL
  const CONST   =  1.214;  // constant

  const form = document.getElementById('calcForm');
  const errorBox = document.getElementById('errorBox');

  const outY = document.getElementById('outY');
  const outP = document.getElementById('outP');
  const outRatio = document.getElementById('outRatio');
  const outRisk = document.getElementById('outRisk');

  const resetBtn = document.getElementById('resetBtn');

  const toggleY = document.getElementById('toggleY');
  const toggleP = document.getElementById('toggleP');
  const formulaY = document.getElementById('formulaY');
  const formulaP = document.getElementById('formulaP');

  function showError(msg){
    errorBox.textContent = msg;
    errorBox.style.display = 'block';
  }
  function clearError(){
    errorBox.textContent = '';
    errorBox.style.display = 'none';
  }

  function getNum(id){
    const el = document.getElementById(id);
    // на випадок, якщо хтось введе кому
    const v = String(el.value).replace(',', '.').trim();
    return v === '' ? NaN : Number(v);
  }

  function riskLabel(p){
    // базова шкала, редагується під твою логіку, якщо треба
    if (!isFinite(p)) return '—';
    if (p < 20) return 'Низький';
    if (p < 50) return 'Помірний';
    return 'Високий';
  }

  function renderFormulaText(){
    formulaY.textContent =
`y = ${K_RATIO}·(GGT/AST) + ${K_ALT}·ALT + ${K_AGE}·AGE + ${K_SEX}·SEX + ${K_CHOL}·CHOL + ${CONST}
де:
SEX = 0 (жінка) або 1 (чоловік)`;
  }

  function calc(){
    clearError();

    const ggt = getNum('ggt');
    const ast = getNum('ast');
    const alt = getNum('alt');
    const age = getNum('age');
    const chol = getNum('chol');
    const sex = Number(form.querySelector('input[name="sex"]:checked').value);

    // Validation (всі обов'язкові)
    const fieldsOk = [ggt, ast, alt, age, chol].every(v => isFinite(v));
    if (!fieldsOk){
      showError('Заповни всі поля коректними числами.');
      return;
    }
    if (ast === 0){
      showError('АСТ не може бути 0 (ділення на нуль).');
      return;
    }
    if (ggt < 0 || ast < 0 || alt < 0 || age < 0 || chol < 0){
      showError('Значення не можуть бути відʼємними.');
      return;
    }

    const ratio = ggt / ast;

    // y
    const y = (K_RATIO * ratio) + (K_ALT * alt) + (K_AGE * age) + (K_SEX * sex) + (K_CHOL * chol) + CONST;

    // p: 1 / (1 + e^(-y)) * 100
    const p = 1 / (1 + Math.exp(-y)) * 100;

    outY.textContent = y.toFixed(3);
    outP.textContent = p.toFixed(1) + ' %';
    outRatio.textContent = ratio.toFixed(3);
    outRisk.textContent = riskLabel(p);
  }

  form.addEventListener('submit', (e) => {
    e.preventDefault();
    calc();
  });

  resetBtn.addEventListener('click', () => {
    clearError();
    form.reset();
    outY.textContent = '—';
    outP.textContent = '—';
    outRatio.textContent = '—';
    outRisk.textContent = '—';
  });

  function setToggle(btn, panel, isOpen){
    btn.dataset.open = String(isOpen);
    panel.style.display = isOpen ? 'block' : 'none';
    btn.textContent = (isOpen ? 'Сховати' : 'Показати') + (btn === toggleY ? ' формулу y' : ' формулу p');
  }

  toggleY.addEventListener('click', () => {
    const open = toggleY.dataset.open !== 'true';
    setToggle(toggleY, formulaY, open);
  });

  toggleP.addEventListener('click', () => {
    const open = toggleP.dataset.open !== 'true';
    setToggle(toggleP, formulaP, open);
  });

  // init
  renderFormulaText();
  setToggle(toggleY, formulaY, false);
  setToggle(toggleP, formulaP, false);
</script>
